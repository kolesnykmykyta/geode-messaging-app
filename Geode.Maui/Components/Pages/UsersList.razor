@page "/users"
@inject IUsersService usersService

<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
<link href="_content/MudBlazor/MudBlazor.min.css" rel="stylesheet" />

<InputText id="search" @bind-Value="@filter.SearchParam" class="form-control"></InputText>

<MudSelect @bind-Value="@filter.SortProp" Label="Sorting parameter">
    <MudSelectItem Value="@("Name")">Name</MudSelectItem>
    <MudSelectItem Value="@("Email")">Email</MudSelectItem>
</MudSelect>

<MudCheckBox @bind-Value="@filter.SortByDescending">Descending</MudCheckBox>

<MudButton Variant="Variant.Filled" Color="Color.Primary" @onclick="UpdateUserList">Apply parameters</MudButton>

<MudDataGrid Items="@usersList">
    <Columns>
        <PropertyColumn Property="x => x.UserName" />
        <PropertyColumn Property="x => x.Email" />
    </Columns>
</MudDataGrid>

@code {
    private IEnumerable<UserInfoDto> usersList = new List<UserInfoDto>();
    private UserListFilterDto filter = new();

    protected override async Task OnInitializedAsync(){
        usersList = await usersService.GetUserListAsync(null);
        filter = new UserListFilterDto();
    }

    private async Task UpdateUserList()
    {
        usersList = await usersService.GetUserListAsync(filter);
    }
}
